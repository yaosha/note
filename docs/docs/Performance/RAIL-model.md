## RAIL性能评估模型

以用户为中心

* Response：立即响应用户，`100ms`内确认用户输入
  * 对超过500ms的操作，始终提供反馈
* Animation：设置动画或滚动时，在`10ms`内生成1帧
  * 目标：每秒生成60帧，每帧约为16ms，但是浏览器绘制新帧到屏幕也需要花费时间，所以只有10ms执行代码
  * 每帧渲染步骤：JS>style>layout>paint>composite
* Idle：最大程度增加主线程的空闲时间
  * 利用空闲时间完成推迟的工作
  * 将推迟的工作分成每个耗时10ms的任务
* Load：持续吸引用户，在`1000ms`内呈现交互内容
  * 优化关键渲染路径
  * 渐进式渲染、在后台执行非必须的推迟加载工作

### 像素管道

![渲染步骤](./frame-full.jpg)

* JavaScript：实现视觉变化效果，还有其他一些常用方法也可以实现视觉变化效果，比如：CSS Animations、Transitions 和 Web Animation API。
* Style：样式计算，根据匹配选择器计算元素应用的CSS规则，应用规则并计算每个元素的最终样式
* Layout：布局，根据上个步骤的结果计算元素占据的空间大小和位置，布局计算还要考虑元素之间的相互影响作用。
* Paint：绘制，在多个层上填充像素的过程。它涉及绘出文本、颜色、图像、边框和阴影，基本上包括元素的每个可视部分。
* Composite：合成，按正确的顺序将元素绘制到屏幕上

每帧在管道的运行方式有三种：
* JS/CSS>style>layout>paint>composite：修改元素的`layout`属性（宽、度、位置等），浏览器将必须检查所有其他元素，重新绘制任何受影响的部分，而且最终绘制的元素需进行合成。
* JS/CSS>style>paint>composite（跳过layout步骤）：修改`paint only`属性（例如背景图片、文字颜色或阴影等），即不会影响页面布局的属性，则浏览器会跳过布局，但仍将执行绘制。
* JS/CSS>style>composite（跳过layout和paint步骤）：更改一个既不要布局也不要绘制的属性，则浏览器将跳到只执行合成。
